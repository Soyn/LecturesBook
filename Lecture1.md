# **Lecrure1**

## Organization of typical system

- **Bus(总线)**
  - 一组电子管道的集合(electrical conduits)
  - 电子管道的是以words为单位的,通常在32位上为4字节, 在64位上为8字节

- **I/O设备**
  - 鼠标键盘,通过控制器或者适配器连接在I/O总线上
  - 控制器和适配器的主要区别是其封装的方式不同,控制器是置于I/O设备本身或者主板上的芯片组,适配器
    是一块插在主板插槽上的卡,但是无论如何,都是为了在I/O总线和I/O设备之间交换数据
- **主存**
  - 用于临时存储需要执行的程序和程序处理的数据
  - 主存是有一组DRAM(Dynamic random access memory)芯片组成
  - 从逻辑上来看内存就像一个线性的字节数组
  - 一个程序是由很多个字节组成, C语言中不同类型的数据占用字节大小不同(比如在IA32 Linux下short
    是2字节,int,float是4字节, double是8字节)
- **处理器**
  - 处理器(center processing unit),是解释(或执行)存储在主存中的指令,处理器的核心是一个字长
    的寄存器(program counter), pc在任何时刻都指向一条主存中的机器指令
  - 从系统通电开始到到系统断电,处理器一直执行pc指向的指令,并更新pc指向下一条指令,指令的操作是由
    指令集决定的.
  - 执行一条机器指令时需要经过一系列的步骤,处理器首先从pc指向的存储器中读入指令,然后解释指令的位
    含义,然后执行指令指示的操作,然后更新pc执行下一条指令
  - 这些简单的操作不多,而且主要是围绕着主存,寄存器文件,算术逻辑单元(ALU),寄存器是由多个一字长
    (word-sized)的寄存器的组成.(每个寄存器都有其自己唯一的名字)
  - 算术逻辑单元(arithmetic/logic unit), ALU计算新数据和地址值;
    - 加载(load): 从主存中复制一个字节或一个字到寄存器中,覆盖掉寄存器以前的内容
    - 存储: 把一个字节或一个字从从寄存器复制到主存中的某个位置
    - 操作: 将两个寄存器中的内容复制到ALU中,ALU对这两个字进行算术操作,并将结果存放在一个寄存器
      中,覆盖掉寄存器以前的内容
    - 跳转: 从机器指令自身中提取一个字,将字复制到PC中,会覆盖掉PC先前的内容

## 缓存
  - 程序的执行中会很多时间都花费在对数据的移动上，例如从磁盘上读取机器指令到主存，从主存上读取
  指令到处理器，从程序员的角度来说这拖慢了程序的执行，所以从系统设计的角度上来说，我们需要保证
  这些数据的移动尽可能的快速，但是矛盾在于，储存量越大的设备便宜但是读取速度很慢，读取速度很快的
  存储器价钱很贵。电脑上的磁盘设备的存储容量是主存的100倍，但是主存的读取速度是磁盘的10，000，
  000倍。
  - 寄存器存储空间只有几百个字节，但是主存有上亿字节，为了解决主存和处理器的处理速度差异，我们
  引入了缓存(cache memory)的机制，作为处理器和主存之间的需要的临时信息的存储，缓存技术使用
  SRAM(static access memory)

## 存储设备的层次结构
  - 在处理器和主存之间插入存储容量更小的访问速度更快的设计已经成为了一个普遍的做法,存储结构层次图中
  由上至下存储容量更大,访问速度更慢,每字节单价更低,在层次结构图中,每一层是比它低一层的缓存

## 操作系统对硬件的管理
  - 操作系统是一个介于计算机硬件和应用程序之间的一层软件,应用程序对硬件的操作都要通过操作系统.
  - 操作系统的作用:
    - 保护计算机硬件不被失控的应用程序滥用
    - 提供给上层应用简单一致的机制去操纵硬件设备

## 进程与线程
  - 进程是操作系统对运行程序的抽象
    - 多个进程可以同时在一个系统上跑(并行),而每个进程好像在独享计算机的硬件
    - 并发运行是指多个进程的指令交替执行
    - 传统系统在一个时刻执行一个程序,而多核系统可以同时执行多个程序,但是不论多核还是单核系统都可以
      多个进程并发执行
    - 单核CPU并发执行多个进程需要cpu进行进程之间的切换(上下文切换)
      - 上下文:操作系统跟踪程序运行的状态信息,这个状态就叫做上下文(PC, 寄存器文件, 主存的内容)
      - 在单处理器系统上任何时刻只能执行单一进程的程序, 当需要从当前进程切换到新的进程时,保存
      当前进程的上下文,执行上下文切换,切换到新的进程,     
  - 线程
    - 现代计算机系统上,一个进程由多个称为线程的执行单元组成,每个线程运行在进程的上下文中,并共享同样的代码
    和全局数据,由于网络服务器对并发的需求,线程成为越来越重要的编程模型,因为线程比起进程更容易共享数据,也因为线程比进程更加高效,所以多线程也是一种可以使程序运行更快的方法.
## 虚拟内存
  - 虚拟内存是对每一个进程的抽象,它为每一个进程提供了一个假象,每个进程独享主存,每一个进程看到的是一致的内存存储器,叫做虚拟内存空间。
